A machine learning task to select the best response to given dialogs 
==
## Task Description
Given the transcript of a conversation and 5 sentence candidates to choose, the model can choose the sentence that is most likely to appear right next to the conversation. 

## Key Results
1.Accuracy: ~53.5% (without ensemble), ~57.5% (ensemble) 
2.Ranked 1st out of 11 teams in the Kaggle competition. [Link](https://www.kaggle.com/c/ml-2018spring-final-tv-conversation/leaderboard) 

1.RNN is used in the model to compare sentence similarity.
2.”Random data processing method” is invented to augment training data, boosting accuracy for 6 %.
3.Detailed description is provided in Report.pdf




[testing command]

If you want to predict on the given testing_data.csv     
bash test.sh dataset/testing_data.csv output_file_path     
If you want to predict on other testing data       
bash test.sh testing_data_path output_file_path



[imported module]

keras 2.0.8      
tensorflow 1.4.0      
gensim 3.4.0     
numpy     
jieba     
random     
time     


[training]

As for training, it is hard to provide a script to do so since the training process is very complicated. Even if we run exactly the same code, we will get different model due to the randomness of the code.     
By the way, since we used five models to do the prediction, it would take at least 72 hour to reproduce the training process even with 1080ti GPU.     
However, we provide all the source code in src directory. We provide a detailed discription bellow:     

model/wt64_clean_model.model is generated by     
1_jieba_corpus.py, 4_word2vec.py     

model/1.h5 is generated by     
1_jieba_corpus.py, prob.py, full35.py     

model/2.h5 is generated by     
1_jieba_corpus.py, prob.py, full31.py     

model/3.h5 is generated by     
1_jieba_corpus.py, prob.py, full39.py     

model/4.h5 is generated by     
1_jieba_corpus.py, prob.py, full35.py     

model/5.h5 is generated by     
1_jieba_corpus.py, prob.py, full31.py     

We use model/wt64_clean_model.model, model/1.h5, model/2.h5, model/3.h5, model/4.h5, model/5.h5, and final_test.py to do the prediction.     
